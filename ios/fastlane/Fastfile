fastlane_version '2.13.0'

before_all do
  # cocoapods
  puts ENV['ICON']
end

desc 'Build app'
lane :build do
  gym(
  scheme: 'WifiUC',
  # provisioning_profile_path: 'AppStore_com.negebauer.Wifi-UC.mobileprovision'
  )
end

desc 'Submit a new Alpha Build to Apple TestFlight'
lane :alpha do
  build
  pilot
end

desc 'Submit a new Beta Build to Apple TestFlight'
lane :beta do
  build
  pilot
end

desc 'Deploy a new version to the App Store'
lane :release do
  build
  deliver(
    skip_screenshots: true,
    skip_metadata: true,
    submit_for_review: true,
    force: true,
    automatic_release: true,
  )
end

desc 'Upload metada and screenshots'
lane :metadata do
  deliver(
    skip_binary_upload: true,
    skip_screenshots: false,
    skip_metadata: false,
    overwrite_screenshots: true,
    app_icon: ENV['ICON'],
    apple_watch_app_icon: ENV['ICON_WATCH'],
    force: true,
    app_version: ENV['VERSION'],
  )
end

after_all do |lane|

end

error do |lane, exception|

end
